{% extends "base.html" %}
{% block content %}
  <div class="row g-4">
    <div class="col-lg-8">
      <div class="card shadow-sm mb-4">
        <div class="card-header"><strong>Quick Links</strong></div>
        <div class="card-body">
          <a class="btn btn-primary me-2" href="{{ url_for('tote_events_page') }}">Tote Events</a>
          <a class="btn btn-outline-primary me-2" href="{{ url_for('tote_pools_page') }}">Tote Pools</a>
          <a class="btn btn-outline-primary me-2" href="{{ url_for('tote_superfecta_page') }}">Superfecta</a>
          
        </div>
      </div>
      <div class="card shadow-sm mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
          <strong>Now / Next Races (60 min)</strong>
          <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('tote_events_page') }}">All Events</a>
        </div>
        <div class="card-body">
          {% if now_next %}
            <div class="table-responsive mb-2">
              <table class="table table-sm align-middle">
                <thead><tr><th>Start</th><th>Event</th><th>Venue</th><th>Country</th><th>Status</th><th></th></tr></thead>
                <tbody>
                  {% for e in now_next %}
                    <tr>
                      <td><span class="time-iso" data-iso="{{ e.start_iso }}">{{ e.start_iso }}</span></td>
                      <td class="text-truncate" style="max-width:320px;">{{ e.name }}</td>
                      <td>{{ e.venue }}</td>
                      <td>{{ e.country }}</td>
                      <td>{{ e.status }}</td>
                      <td><a class="btn btn-sm btn-outline-primary" href="{{ url_for('event_detail', event_id=e.event_id) }}">View</a></td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <em class="text-muted">No horse races starting in the next hour.</em>
          {% endif %}
          {% if now_next_sf %}
            <div class="small text-muted">Upcoming Superfecta pools: {{ now_next_sf|length }}</div>
          {% endif %}
        </div>
      </div>
      <div class="card shadow-sm mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
          <strong>Upcoming Superfecta (60 min)</strong>
          <a class="btn btn-sm btn-outline-primary" href="{{ url_for('tote_superfecta_page') }}">Superfecta</a>
        </div>
        <div class="card-body">
          {% if now_next_sf %}
            <div class="table-responsive">
              <table class="table table-sm align-middle">
                <thead><tr><th>Start</th><th>Event</th><th>Venue</th><th>Status</th><th>Currency</th><th>Total Net</th><th>Product</th></tr></thead>
                <tbody>
                  {% for p in now_next_sf %}
                  <tr>
                    <td><span class="time-iso" data-iso="{{ p.start_iso }}">{{ p.start_iso }}</span></td>
                    <td class="text-truncate" style="max-width:300px;">{{ p.event_name }}</td>
                    <td>{{ p.venue }}</td>
                    <td>{{ p.status }}</td>
                    <td>{{ p.currency }}</td>
                    <td>{{ p.total_net | f2 }}</td>
                    <td class="text-truncate" style="max-width:240px;">
                      <a href="{{ url_for('tote_superfecta_detail', product_id=p.product_id) }}">{{ p.product_id }}</a>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <em class="text-muted">No superfecta pools starting in the next hour.</em>
          {% endif %}
        </div>
      </div>
    </div>
    
  </div>
{% endblock %}
